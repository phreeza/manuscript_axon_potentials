---
geometry: a4paper
documentclass: article
figPrefix:
  - "Figure"
  - "Figures"
header-includes:
    - \usepackage{setspace}
    - \doublespacing
author: 
    - Thomas McColgan
    - Ji Liu
    - Paula T Kuokkanen
    - Catherine E Carr
    - Hermann Wagner
    - Richard Kempter
title: Extracellular potentials generated by axonal projections are shaped by patterns of bifurcations and terminations

date: \today
...

Introduction
==============
Extracellular field potentials (EFPs) are at the heart of many experimental
methods used to examine the inner workings of the brain.  This includes
invasively recorded signals such as electrocorticogram (ECoG), local field
potentials (LFP), current source density (CSD) and multiunit activity (MUA) as
well as the noninvasively recorded electroencephalogram (EEG) and the auditory
brainstem response (ABR) [@Brette2012Handbook; @Nunez2006Electric]. The origins
of these signals, especially in cases in which the activity is not clearly
attributable to a single cell, is a matter of debate.

EFPs in the brain were long thought to be primarily synaptic in origin
[@Buzsaki2012Origin]. As a consequence, many modeling studies focussed on the
extracellular fields induced by synaptic currents on the dendrites and the soma
of a postsynaptic neuron [@Gold2006Origin; @Holt1999Electrical;
@Einevoll2013Modelling; @Linden2011Modeling; @Linden2010Intrinsic;
@FernandezRuiz2013Cytoarchitectonic]. However, a number of recent data analysis
and modeling efforts have revealed that active, non-synaptic membrane currents
can play an important role in generating EFPs [@Reimann2013Biophysically;
@Anastassiou2015Cell; @Schomburg2012Spiking; @Ray2011Different;
@Belluscio2012CrossFrequency], including far reaching potentials detectable at
the scalp [@Telenczuk2011Highfrequency; @Telenczuk2015Correlates]. However,
currents from the axon are still thought to be so small as to be of minor
importance for the EFP.

One of the reasons for the traditional assumption that axonal currents
contribute little to the EFP is that the far field of an action potential
traveling along an idealized straight axon is quadrupolar, meaning that it
decays faster with distance than synaptic sources, which are thought to be
dipolar [@Nunez2006Electric]. However, in experimental studies that recorded
the EFP of axonal responses, the EFP often has a dipolar structure. For
example, @Blot2014Ultrarapid report an EFP with the characteristic dipolar
structure recorded from the vicinity of cerebellar Purkinje cell axons.
@Swadlow2002Activation showed that the axonal part of the EFP of
thalamocortical afferents also showed a polarity reversal as associated with
a dipolar source. In the results section we will present a further new example
of such a field potential from the auditory brainstem of the barn owl.

This discrepancy between the quadrupolar structure of EFPs generated by axons,
as predicted by theory and its dipolar nature as observed in experiment raises
the question of how axons are able to generate dipolar field potentials.

The aim of this study is to show how dipolar far fields in the EFP of axons can
be explained by the axons' anatomical structure. In particular, we show that
the branchings and terminations of axons in their projection area lead to
a dipolar EFP structure. Such axon bundles, often also called nerves or
fascicles, exist throughout the peripheral and central nervous system of most
animals [@kandel2000principles; @Hentschel1999Models; @Nornes1972Temporal;
@Goodman1984Cell]. The white matter of the mammalian brain can be viewed as an
agglomeration of such bundles [@Schuz2002Human]. We therefore predict
pronounced contributions of nerves or fascicles to EFPs, which are neglected in
all current models.

Properties of the EFP due to axonal projections are first investigated by
a numerical model based on forward simulation [@Holt1999Electrical;
@Gold2006Origin]. This first model includes a large-scale multicompartment
model of an axon population. We then show a concrete example of the effects in
experimental data using as a set of multi-site in-vivo electrophysiological
recordings from the barn owl brain stem. Finally, we outline the mechanisms
underlying the observed effects by means of a second, analytically tractable,
model of a generic axon bundle. 

Results
==============

*Effects of axonal morphologies on extracellular action potentials* To
understand how the geometry of an axon affects the extracellular waveform
associated with a single action potential, we numerically simulated action
potentials propagating along generic axons and calculated their contribution to
the EFP. We began by simulating an infinitely long axon following a straight
line path, neither bifurcating nor terminating ([@fig:simpletree]A). The
extracellular action potential has the characteristic triphasic shape. As the
action potential travels from top to bottom, the waveform is translated in time
with the conduction velocity, but is otherwise unchanged.

There are two ways of understanding the triphasic shape of the extracellular
waveform. The first is by attribution of the peaks of the response to
individual current types. The first, positive peak corresponds to the capacitive
current, the large second peak to the sodium current, and the final peak to the
potassium current [@Gold2006Origin]. A second approach is specific to the
nature of the axon. Due to Kirchoff's law and cable theory, the total
transmembrane current in a single axon is proportional to the second derivative
of the membrane voltage along the direction of the axon. Because the action
potential is roughly a travelling wave, the currents are also proportional to
the second temporal derivative of the membrane potential. The peaks of the EFP
are therefor related to the points of high curvature in the action potential
waveform, namely the onset, the maximum and the end of the spike.

Next we simulated the response of an axon that terminates ([@fig:simpletree]B).
Here the approaching action potential (top traces) can be seen to have the
same, triphasic shape as in the non-branching case. When it reaches the
termination, it gradually deforms into a biphasic response, with the positive
peak preceding the negative peak. The biphasic appearance can be understood by
considering the locations of the currents as they are summed up. As the action
potential approaches the recording location, the majority of the currents flow
before the termination, and are identical to those in the non-terminating case,
and the first peak is not affected. In the second half of the action potential,
the majority of the currents in the non-bifurcating axon flow after the
electrode location. Because the axon terminates here, these currents are no
longer present, leading to a partial suppression of the second peak and a
complete suppression of the third peak.

A common structure found in axons is a bifurcation. We simulated a single axon
which bifurcates three times on each branch within a distance of 50 $\mu$m,
leading to a total number of 8 fibers leaving the bifurcation zone
([@fig:simpletree]C). We chose to simulate several bifurcations because this
leads to a clearer effect in the EFP. A single bifurcation shows the same
behaviour, but to a lesser degree. The potential near this bifurcating axon
also has a more biphasic shape. There is an initial small positive peak, but the response
is dominated by the second, negative and the third, positive peak. This can be
understood by comparing the shape to the previous example along
a non-bifurcating axon: The initial peak resembles the non-bifurcating case,
because the action potential is still mainly within the part of the axon before the
bifurcation. As the action potential passes the bifurcation zone, there are now
several instances of the action potential, and the second and third peak are
multiplied in size, leading to the more biphasic response. In the case of
a single bifurcation, this effect is also present, but the amplification of the
second and third peak relative to the first peak is not as notable as in this
example.

To understand how bifurcations and terminations interact when they are present
in the same axon, we simulated an axon with an identical number of bifurcations
as in the previous case, but then added terminations to all the fibers 200
$\mu$m after the bifurcation zone ([@fig:simpletree]D). We found that this
leads to the same biphasic responses observed as observed in the cases of the
isolated anatomical features, with the triphasic response occurring briefly
in-between the two features. A notable point here is that the potential at the
bifurcation and termination are similar in shape, but opposite in
polarity. 

Moving towards more biologically plausible axon geometries, we next considered
a population of axons with slightly altered characteristics. The basic
structure for each axon in the population was the same as in
[@fig:simpletree]D, but we randomly perturbed the precise locations of each
bifurcation and termination in the tree ([@fig:simpletree]E, left). We
furthermore stimulated each axon with an inhomogeneous Poisson spike train. The
driving rate of the inhomogeneous Poisson process was the same for all axons
and was constituted from a constant background rate and a gaussian pulse of
heightened activity. The resulting extracellular potential ([@fig:simpletree]E,
right) showed a polarity reversal similar to that seen in the single axon
potentials. In contrast the single spike and single axon case, the potential at
the center of the projection zone largely cancelled out because the differences
in spike timing across fibers.

The population response shows the polarity-reversing behaviour as the single
axon containing bifurcations and terminations in [@fig:simpletree]D, but the
sustained activity leads the potential to largely cancel out in the middle of
the projection zone. This is similar to the polarity reversal associated with
a dipole observed in experimental studies (@Swadlow2002Activation;
@Blot2014Ultrarapid; this study). We have shown that simple model axon
structures can produce complex and diverse spatiotemporal responses comparable
to some responses found in experiments.

*Axonal projections generate a dipole-like field potential.*

To further understand how axons can generate a dipolar EFP, we simulated a
parallel fiber bundle that at first runs at constant diameter without
bifurcations and then reaches a projection zone. Within this projection zone,
the fibers first bifurcate, which increases the number of fibers. Finally, the
axons reach a termination zone, in which the number of fibers decreases to zero
([@fig:bigtree]A). To model more closely the actual axonal structures found in
nature, we also extended the model axons to include a radial fanning out of the
branches, as well as a more diverse set of morphologies including a variable
number of bifurcations and terminations.

The spiking activity of a generic axon bundle was simulated by stimulating the
fibers with a background spontaneous firing rate of 100 spikes/second, upon
which a pulse of increased activity was added. This pulse of activity could
relate to any kind of evoked activity in the nervous system, such as a sensory
stimulation, motor activity or a spontaneous transient increase in population
spiking activity. We chose a gaussian pulse with an amplitude of 2900
spikes/second and a standard deviation of 2.8 ms.

![Relationship between axon structure and extracellular potential. The top row
shows simulated action potentials travelling along a single axon with varying
morphologies, as indicated by the diagram in the left side of each subfigure.
Action potential propagation direction indicated by the arrow. All waveforms
recorded at a distance of 150$\mu$m from the axon, and at the depth indicated
by plot position, spaced by 200$\mu$m. (**A**) An action potential in an
infinitely long, straight axon. (**B**) Effect of a terminating axon.  Action
potential waveform closest to the termination thickened for emphasis. Scale of
A and B is indicated by the scalebar in their middle.  (**C**) Effect of a
branching axon. The axon branches multiple times in the range of 200$\mu$m.
Thicker waveform at the center of the bifurcation zone.  (**D**) Combined
effect of bifurcations and terminations. Scale for C and D is reduced by a
factor of 8, indicated by scalebar in their middle. The lower row shows
responses of a population of 100 randomly branching and terminating axons.
(**E**) Response in a population of randomized morphologies, three of which
are shown schematically. Activity consists of spontaneous background activity
superimposed with a pulse of heightened spike rate. Spike rate and example spike
times for the three morphologies are shown at the top. Gray lines show activity
averaged over 40 trials, while the black lines show the limit of infinitely many
trials.](../figs/fig_1_nocsd.pdf){#fig:simpletree}

To characterize the spatiotemporal dynamics of the evoked EFP, the potential
was calculated for several locations along the axon trunk. Because we first
want to study the effect of the rate pulse on the EFP, we low-pass filtered the
EFP responses with a cut-off frequency of 1 kHz ([@fig:bigtree]B). The
distribution of maximum amplitudes of these responses are shown by the  colored
contour lines in [@fig:bigtree]A and the colored voltage traces in [@fig:bigtree]B.
Surrounding the projection zone of the axon bundle, amplitudes show the
double-lobed shape typical of a dipole.

In [@fig:bigtree]B, all the responses showed a biphasic deflection that was elicited
by the population firing rate pulse. This deflection was visible at all
recording locations. The biphasic deflection reverses polarity in the middle of
the bifurcation zone of the bundle (red box in [@fig:bigtree]B). The polarity
reversal occurs by a decrease of the amplitude to zero and a subsequent
reappearance with reversed polarity, as opposed to a polarity reversal through
a gradual shift in phase. This behaviour is also typical for a dipolar field
potential.

The point of the polarity reversal coincides roughly with the middle of the
projection zone. This means that the absolute value of the response amplitude
reaches a local minimum just when the number of axonal fibers reaches a
maximum. To better understand how anatomical features and response amplitude
are related, we compared the signed maximum value (meaning the *signed* value
corresponding to the maximum *absolute* amplitude) of the EFP (red line in
[@fig:bigtree]C) with the difference in the density of branchings and
terminations (black histogram in [@fig:bigtree]C).

Along the nerve trunk the fiber density is constant. As the axon bundle reaches
its projection zone, the number of bifurcations increases. In the middle of the
projection zone, the number of bifurcations and terminations cancels out. At
the same depth, the amplitude of the low-frequency component crosses zero.  As
the end of the projection zone approaches, the terminations outweigh the
bifurcations. As the axon bundle ends, there are no longer any bifurcations or
terminations, and the density decays toward zero. Overall, the amplitude of the
maximum response (red trace) follows the distribution of branchings and
terminations (black histogram). 

The progression of amplitudes in the low-frequency components seen in
[@fig:bigtree]C is also visible in [@fig:bigtree]B, most clearly in the first
column. The polarity reversal in the red box in [@fig:bigtree]B corresponds to
the crossing of zero amplitude in figure [@fig:bigtree]C.

![Axonal projections generate a dipole-like extracellular field potential (EFP)
when stimulated with  a pulse of activity. **A** Modeled axon bundle in black,
along with iso-amplitude lines for the low-pass filtered EFP signature of the
activity pulse. The contours (maximum amplitude in mV as indicated by colorbar)
show the typical double-lobe of a dipole. **B** The waveforms, recorded at the
locations of the colored dots in *A* also show a polarity reversal (red box).
The reversal ocurrs by inverting the envelope with aproximately constant phase,
not by a shifting of phase with constant envelope. **C** Progression of the
maximum amplitude with depth (red line). It closely follows the local
difference in density between bifurcations and terminations (black histogram).
**D** Iso-amlitude contours for the high-frequency component, which do not
exhibit a doiuble-lobed structure. **E** Response waveforms of the
low-frequency component. The responses do not reverse their polarity. **F**
Maximum amplitude of the high-frequency component (red line) follows the
density of fibers (black histogram).
](../figs/fig_2.pdf){#fig:bigtree}

<!--To better understand the relationship between axonal anatomy and this spatial
structure of the EFP, we plotted the change in density of the bundle, meaning
the number of terminations subtracted from the number of bifurcations at a
given 

The low-frequency component shows a distinct relationship to the anatomy: it
appears to be governed by the local density of bifurcations and terminations.
Along the nerve trunk the fiber density is constant, and the low frequency
component is unchanged. As the axon bundle reaches its projection zone, the
number of bifurcations increases, and the low frequency component increases in
amplitude. In the middle of the projection zone, the number of bifurcations and
terminations cancels out.  Correspondingly, the low-frequency component
amplitude reaches a local minimum.  As the end of the projection zone
approaches, the terminations outweigh the bifurcations, and the amplitude
increases, but the polarity is reversed (red box in [@fig:bigtree]B). As the
axon bundle ends, there are no longer any bifurcations or terminations, and the
amplitude decays.

The same distribution of maximum amplitudes for the high-frequency component,
shown in [@fig:bigtree]D, did not show the same lobed shape. Instead it decayed
much faster with distance in both axial and radial direction. This was also
reflected in the waveforms (Fig 1E). There is an increase in amplitude due to
the firing rate pulse at locations close to the nerve bundle, but at locations
further away from the trunk it is no longer distinguishable from the background
activity.-->

To understand the contributions related to individual spikes, we next turned
our attention to the high-frequency range. We calculated the multi-unit
activity (MUA) of the response (see Methods), which reflects the high-frequency
(>1kHz) components of the response, and is thought to reflect spiking activity
in extracellular recordings. The MUA did not show a double-lobe, but rather
appeared like an ellipsoid centered at the projection zone ([@fig:bigtree]D).

The waveform of the MUA response was not modulated heavily in space, with the
exception of the scaling of the amplitude ([@fig:bigtree]E). The amplitude
decays with radial distance from the trunk. The amplitude reaches its maximum
at the middle of the fiber bundle.

The longitudinal behaviour is further examined in [@fig:bigtree]F. The
amplitude of the MUA component (red trace) changes its amplitude in the
longitudinal direction in accordance to the local fiber density (black
histogram). It has an approximately constant amplitude along the nerve trunk
and then increases in amplitude as the fiber density is increased by
bifurcations. As the fibers terminate and fiber density decreases, so does the
amplitude of the MUA.

We have thus shown a qualitatively different behaviour in the low- and
high-frequency components of the EFP. Both appear to be related to anatomy,
though each in a different way. Together, these relationships suggest that the
particular branching and terminating structure of the axon bundle gives rise to
the dipolar field potential.

*Effects of anatomy on distance scaling behaviour of EFPs*

Because dipolar fields are associated with a longer spatial reach than the
quadrupolar fields typically associated with axonal spikes, we decided to
investigate the effect that axon structure has on the spatial reach of the
frequency components ([@fig:distscaling]). To do this we performed a further
simulation of an axon bundle. In this case we simulated two versions of the
axon bundle, one containing a projection zone with bifurcations, and one
Without bifurcations in which a fixed number of fibers arrives and then
terminates.

To avoid confounding effects in the spatial reach of the potentials, and afford
better analytic tractability, we transitioned to a simplified model of the axon
bundle. This model omitted the radial fanning out of the bundle in the
projection zone used in the simulation of [@fig:bigtree]. Furthermore, the
simplified model discarded the detailed conductance-based simulation of the
membrane potential, and instead assumed a given membrane potential travelling
along the axon trunk with constant propagation velocity. Using linear cable
theory, it was then possible to calculate the membrane currents necessary for
determination of the EFP. The simplified model also allowed us to consider a
continuous fiber density instead of simulating discrete bifurcations and
bifurcations. All following simulations are based on this simplified model.

The dipole-like component observed in [@fig:bigtree] had it's dipole axis
aligned with the axon trunk. We therefore expect the field potential to decay
quadratically in this direction, which we call the axial direction. To test
this, we plotted the amplitude of the low-frequency component for low
frequencies in axial direction in [@fig:distscaling]A. The plot is on a double
logarithmic scale, meaning that the slope of the curve corresponds to the
scaling exponent, and the vertical offset corresponds to the amplitude of the
component. We observe quadratic scaling with distance for distances larger than
$\approx 1$ mm, but the amplitude of the low-frequency component remains an
order of magnitude larger in the bifurcating case (solid line) than in the
non-bifurcating case (dashed line). Next we examined the high-frequency
component ([@fig:distscaling]B). Here the asymptotic scaling is also quadratic
for distances $\gtrsim 1$ mm, but the amplitudes are similar. The difference
between the amplitudes is much smaller than in the low-frequency case, even
though amplitudes are the same at short distances $\lesssim 100 \mu$m. At these
distances, the difference is proportional to the number of fibers, which is
larger in the bifurcating case. To conclude, the projection zone contributes
mainly to the low-frequency dipole moment of the EFP.

In contrast to the axial direction, the dipole hypothesis predicts a different
scaling behaviour of the EFP for the radial direction. The dipole component becomes
zero in the direction perpendicular to the dipole axis, and we thus expected quadrupolar
or higher-order scaling behaviour in this case. In [@fig:distscaling]C we can
see that this is indeed the case for the low-frequency component. The
potentials scale as $r^{-3}$, and the amplitude is roughly unchanged. The
high-frequency component also decayed cubically in the radial direction
([@fig:distscaling]D), and the difference in amplitudes was slightly diminished.

To better understand the frequency-specific contributions to the dipole
moments, we calculated the scaling behaviour as a function of frequency. The
amplitude of the dipole moment was determined by fitting a straight line with
slope $-2$ to the double logarithmic scaling of the power spectral density. The
power spectral density was averaged over a frequency band 500 Hz wide, and the
fit was performed for distances $> 1$ mm. The y-intecept of this straight line
then gave the dipole moments. Frequency-specific dipole moments are shown in
[@fig:distscaling]E. We can see that the dipole moment in the bifurcating case
(solid line) exceeds the non-bifurcating case (dashed line) for low
frequencies. The dipole moment of the bifurcating case has a maximum at around
1 kHz, while in the non-bifurcating case it decays monotonically. For higher
frequencies, the moments become roughly equal.

The dipolar component will dominate the EFP at long distances in all directions
except for those perpendicular to the dipole axis. At shorter distances, and in
the plane perpendicular to the dipole axis, the quadrupolar component becomes
important. For this reason we performed the same analysis for the quadrupole
moments ([@fig:distscaling]F). Here the moments are similar for very low
frequencies, then diverge at intermediate frequencies, before approaching each
other again for high frequencies. The quadrupole moment of the bifurcating case
has a maximum at around 2kHz.

In [@fig:distscaling]G we compare the relative impact of the projection zone on
dipole (red line) and quadrupole moments (black line), by plotting their ratios
of across frequencies. Here we can see that for low frequencies, the ratio for
the quadrupole moment approaches unity, meaning that there is no additional
contribution from the projection zone. The dipole moment approaches a factor of
10, meaning that the projection zone contributes. In both components, the
contribution is maximal for intermediate frequencies, with the maximal dipolar
contribution lying at lower frequencies than the quadrupolar component. For
very high frequencies, both contributions return to 1. Both components exceed
the ratio of 10, which is the maximal increase in the number of fibers in the
bifurcating case compared to the non-bifurcating case.

Together, these observations show us that the projection makes a strong
contribution to the far-reaching dipole field potential of the axon bundle. At
higher frequencies, the more local quadrupolar potential is also affected.

![The low-frequency component of the axon bundle EFP exceeds the high-frequency
component in reach, in a manner depending on axon structure. Subplots
**A**-**D** show the scaling of the low-frequency (blue lines) and
high-frequency (green lines) frequency components for the bifurcating (solid
lines) and non-bifurcating (dashed lines) on a doubly-logarithmic scale. All
distances are calculated from the center of the projection zone. (**A**)
Scaling behaviour in the axial direction for the low-frequency component.
(**B**) Behaviour of the high-frequency components in the axial direction.
(**C**) and (**D**) Scaling behaviour of low- and high-frequency components in
the radial direction. The next panels show the (**E**) dipole moment and
(**F**) quadrupole moment of the bifurcating and non-bifurcating bundles as a
function of frequency. (**G**) Ratio of the dipole moment (red line) and
quadrupole moment (black line) between bifurcating and nonbifurcating case.
](../figs/fig_3.pdf){#fig:distscaling height=115%}

*The barn owl neurophonic as an example that shows a projection zone related dipolar field.*

In order to test our model of the extracellular field of axon bundles, we
compared it to recordings from the barn owl auditory brain stem.

The barn owl is well known for it's highly developed auditory system. One of
the features of the system is the strong frequency following response in the
EFP recorded in the nucleus laminaris (NL), called the neurophonic. In NL, the
input from the two ears is first integrated to calculate the azimuthal location
of a sound source, and this information is encoded in the EFP. In previous
studies it has been shown that the EFP in this region is mainly due to the
efferent axons and synaptic currents, and the spiking contribution of
postsynaptic neurons is minimal [@Kuokkanen2010Origin]. Furthermore, the
anatomy of the efferent axons is well known and follows a stereotypical pattern
[@carr90]: Two fiber bundles enter the nucleus, with fibers from the
contralateral ear entering ventrally, and from the ipsilateral ear entering
dorsally. This well studied physiology and anatomy makes the system an ideal
candidate to study the EFPs of axon bundles.

To study the spatiotemporal structure of the EFP in NL, we performed
simultaneous recordings of the response in NL to ipsilateral monaural click
stimuli. The click responses showed a distinct high- and low-frequency
component as previously reported [@wagner09]. The high-frequency ringing
corresponds to the position on the frequency map within NL being recorded from.
We filtered the data to roughly separate these components. The cutoff to split
the components was set to 2 kHz, because this frequency was always well below
the high-frequency ringing component, which usually dominated the spectra.

The model was fit to the data by performing a nonlinear least squares
optimization. Free parameters were (1) the fiber density at each recording
location, (2) the average membrane potential over time in a single fiber at the
location next to the most dorsal electrode, (3) the conduction velocity and (4)
the distance between bundle and electrode array.

![Axonal field potentials from the barn owl follow structure predicted by
model. (**Aa**) High-frequency component of the EFP in response to a click
stimulus at $t=0$ ms, at different depths in nucleus laminaris. The depth is
measured in the direction from dorsal to ventral. Recorded responses (green
lines) are shown along with model fit (red lines). (**Ab**) Low frequency
responses in recordings (green) and model (red). (**B**) Average membrane
voltage in a single fiber in the model when fit to the data shown in A. (**C**)
Fiber density in the model fit at the recording
locations.](../figs/fig_4.pdf){#fig:barnowl height=115%}

The resulting EFP responses and the model fit are shown in [@fig:barnowl]A.
[@fig:barnowl]A shows the high-frequency ($\geq 2$ kHz) response. The green
lines show the actual responses in the data. The responses are have a
Gabor-like shape, as expected [@wagner09], and have their maximal amplitude in
the center of the recording array, at around $850 \mu$m recording depth. Toward
the edges, the amplitude decays. In the central region, a systematic shift in
delay can be observed, while the response seems to be stationary in the more
dorsal and ventral electrodes. The shift in delay increases from ventral to
dorsal, which is consistent with the anatomy. All these aspects are
qualitatively reproduced by the model (red traces). The main deviation between
model and data lies in a slightly diminished amplitude of the oscillation at
the most central electrode sites. Because the phase shift in the central region
is mainly determined by the conduction velocity, this might be due to the model
being unable to track a slightly changing conduction velocity in the nucleus. A
diminished amplitude in the model fit could reflect an inability to exactly
match the phase progression. Another possible explanation is that the
additional amplitude could be due to non-axonal sources such as postsynaptic
spikes, which do not follow the assumptions underlying the model being fit.

[@fig:barnowl]B shows the low-frequency ($30$ Hz - $2$ kHz) responses. Here we
can see the typical polarity reversal observed in earlier figures. The
responses at the dorsal and ventral edges show the same shape, but with the
polarity inverted. The central responses show a diminished maximum amplitude,
but not a total cancellation of the response (as expected for a pure dipole).
This is due to the contribution of the more local quadrupole component at this
location relatively close to the activated fibers. The model is able to capture
the behaviour of this component as well, with a slight underestimation of the
amplitude of the peak at ventral locations, and a small oscillation in the data
with period of $\approx 1$ ms in the center of the recording. Here, too, the
deviations might be due to a slightly inhomogenous conduction velocity or
non-axonal sources.

[@fig:barnowl]C shows the average membrane voltage next to the first electrode
over time that was inferred in order to fit the model to the data. The shape
corresponds to the peri-stimulus time histogram (PSTH) convolved with the
average waveform of a spike. It is composed of high and low-frequency
components similar to those observed in the EFP. The most salient difference is
that in the EFP, the low-frequency component has a comparable amplitude to the
high-frequency component, but in the membrane voltage the low-frequency
component is much larger. This is due to the fact that the second derivative
term in the current equation essentially imposes a high-pass filter on the
membrane voltage.

The inferred fiber density is shown in [@fig:barnowl]D. The density has its
maximum at the center of the electrode array, and decays steadily to both
sides. This fiber density profile is consistent with the known anatomy of axons
in NL. The density does not decay to zero on either side, which may be due to
the limited range of recording locations. The fiber density beyond the border
of the nucleus in dorsal direction should be zero.

Discussion
==============
Based on numerical simulations, analytical calculations and experimental data,
we show that axonal fiber bundles can contribute significantly to the EFP, and
how the contributions are shaped by axonal morphology. We characterize three
principal effects of axon bundle structure on the EFP. Firstly, the
low-frequency components of the EFP are governed by the densities of
bifurcations and terminations and can have a dipolar structure. Secondly, the
high-frequency components are governed by the local fiber density. Furthermore
we show that the low-frequency components exceed the high-frequency components
in spatial reach. In particular, the dipolar low-frequency components exceed
the reach of the presumed quadrupolar nature of axonal EFPs.

The two frequency components show qualitatively different behaviour across
recording locations. The low-frequency component is a largely
stationary phenomenon, while the high-frequency component is shifted in space
according to the axonal conduction velocity. Due to the difference in reach,
the high-frequency component is most suitable for the study of local phenomena,
while the low-frequency component can radiate to more distant recording
locations.

These findings relate to the interpretation of a wide range of
electrophysiological data. Heuristics which are valid for the analysis of EFPs
of synaptic, dendritic, or somatic currents may not be valid for axon bundles.
When performing a typical current source density analysis, the underlying
assumption is that the local fiber density is constant among recording
locations, while the membrane voltage varies with time and location
independently. In the case of an axonal fiber bundle as discussed here, the
opposite is the case: fiber density is variable in space, in particular in the
projection zone, but the membrane voltage is highly correlated over space and
time.



- Relevance of Findings
nt currents
    - Dipole has far field, ABR response?
    - more methods?
- Compare to other auditory systems (Chicken NL, MSO)
    - Speculate on functional relevance of polarity shift (a la Rinzel & Goldwyn, Weiss 2010, Einevoll&Panzeri review)
- Two simultaneous modes: stationary dipole and continuous (cf Mc Laughlin, etc).
- compare to other fiber bundle systems
- Importance of preferential direction of axonal arbor. Compare tu Cuntz approach.

<!--TODO: adapt this paragraph for new context -->
It is interesting to note that a similar reversal of polarity in NL has been
reported for chicken [@Schwarz1992Can], as well as in the mammalian analog to
NL, the medial superior olive [@Laughlin2010Oscillatory]. The phase reversal in
this case has been modeled based on the assumption that the postsynaptic NL and
MSO dendrites with their bipolar morphology have a dipolar EFP response
[@Laughlin2010Oscillatory; @Goldwyn2014Model]. However, in the owl this dipolar
morphology is largely absent [@carr90], making dendritic sources unlikely.

Methods
==============

Experimental recordings
-----------------------

The experiments were conducted at the Department of Biology of the University
Maryland. Data was collected from three barn owls (Tyto furcata pratincola.
Procedures conformed to NIH Guidelines for Animal Research and were approved by
the Animal Care and Use Committee of the University of Maryland. Anaesthesia
was induced by intramuscular injections of $XX-YY$~mg/kg/hr urethane.
Supplementary doses were administered to maintain a suitable plane of
anaesthesia. Body temperature was maintained at $39^\circ$C by a
feedback-controlled heating blanket.

Recordings were made in a sound-attenuating chamber (Acoustic Systems Inc.).
Tungsten electrodes with impedances between $2$ and $20$~M$\Omega$ were used to
find suitable recording locations in NL. Once NL had been located, the
electrode was retracted and replaced with a 32 channel multi-electrode array
(A1x32-15mm-50-413-A32, Neuronexus, Ann Arbor, MI, USA). The
multi-electrode array was lowered using a microdrive (MP225, Sutter
Instruments Co., Novato, CA, USA), during continuous presentation of a white noise burst stimulus,
until visual inspection of the waveform showed that NL was at the center of the
array. A grounded silver chloride pellet, placed under the animal's skin around
the incision, served as the reference electrode. Electrode signals were
amplified by a headstage (HS36, Neuralynx Inc., Tucson, AZ, USA). An adapter(ADPT-HS36-N2T-32A,
Neuralynx Inc.) is used between electrode and the headstage. Pre-amplified
electrode signals were passed to an ERP27 (Neuralynx Inc.) and then to four
8-channel amplifier (Lynx-8 amplifier, Neuralynx Inc.), and then to an
analogue-to-digital converter (Cheetah Digital Interface, Neuralynx Inc.)
connected to a personal computer running Cheetah5 software (Neuralynx Inc.),
where the responses were stored for off-line analysis. An
adapter(ADPT-HS-36-ERP-27, Neuralynx Inc.) is used between HS36 and ERP27 in
order to map all 32 channels to the 4 amplifiers. 

Acoustic stimuli were digitally generated by a custom-made \textsc{MatLab}
(MathWorks, Natick, MA, USA) script driving a signal-processing board (RX6,
Tucker-Davis Techonologies) at a sampling rate of 200 kHz(the actual realizable
sampling rate of RX6 for 200kHz is 195312.5Hz). The sound stimuli were
attenuated using PA5 (Tucker-Davis Techonologies, Alachua, FL, USA). Click
stimuli were generated as a single half-wave of a 5kHz sine tone. Miniature
earphones were inserted into the owl's ear canals and fixed to the headplate.
Acoustic stimuli were fed to these earphones. Stimulus delivery was triggered
by National Instruments equipment (NI USB-6259 and BNC-2090A, National
Instruments Inc, Austin, TX, USA), and stimulus presentation times were
recorded along with the responses. Trigger pulses are configured in \textsc{MatLab}
through Ephus software (HHMI/Janelia Farm).

Numerical model
---------------------

We modeled the axons using NEURON [@Hines1997NEURON; @Hines2009NEURON] in a
model based on previous work by @Kuba2009Roles, including the high and low
threshold potassium channels used by @Rathouz1998Characterization. The axon was
modeled as a sequence of active nodes and passive myelinated segments. Unlike
previous models, we included branching axons in our simulations. These were
generated by connecting two passive segments to a node, and continuing the
alternation of active and passive segment in each resulting branch. The
myelinated segments and nodes had lengths of 75 $\mu$m and 2 $\mu$m,
respectively, except for the last segment, which was scaled in order to obtain
the total desired length before the next bifurcation or termination.

At the designated spike times, a special conductance was temporarily activated
in the first node of Ranvier, causing the axon to fire. The soma and axon
initial segment was not modeled explicitly. The conductance had a reversal
potential of 0 mV, a maximal amplitude of 0.05 $\mu$S, and a timecourse
described by an alpha-function with time constant 0.01 ms.

In the simplified axon geometries used in [@fig:simpletree], the branching
pattern was fixed by hand as described in the caption, with the exception of
the axial position of the branching points in subfigure E, where a random
offset between branching points was drawn from a gamma distribution with mean
400 $\mu$m a standard deviation of 300 $\mu$m. The initial branching point was
offset from the location in the previous cases by a distance drawn from a
Gaussian distribution with mean zero and a standard deviation of 300 $\mu$m.

For the axon populations in [@fig:bigtree], branching patterns were generated
procedurally, starting with the root segment. In order to avoid artifacts from
the stimulus and to simulate the fiber tract prior to the projection zone, a
sequence of 10 active and passive segments without bifurcations was added
before the projection zone. To this root, segments were appended iteratively.
Before adding a segment, a decision whether to branch or terminate an axon was
drawn from a probability distribution dependent on the axial position of the
end of the previous segment. These probability distributions were modeled as
logistic functions with the parameters adjusted to roughly match the numbers of
branchings and terminations found in the tracings shown in publications such as
@carr90. This meant that an initial phase of bifurcations was followed by a
phase of terminations, with the probability of termination reaching 100\% at
the end of the projection zone. The distribution of bifurcations had it's
maximum at location $z=0$ and a standard deviation of 200 $\mu$m, and the
terminations at $z=500\quad\mu$m, with a standard deviation of 100 $\mu$m. The
branching angle had an average of $20^\circ$, with a standard deviation of
$5^\circ$.

The simulations of these axons yielded the membrane currents, from which we
calculated the extracellular fields. The procedure for this is described in
detail by @Gold2006Origin, among others. Briefly, the extracellular medium is
assumed to be a homogeneous volume conductor with conductivity $\sigma_e$, and
a quasi-static approximation of the electrical field potential $\phi$ is made.
The extracellular potential $\phi(\mathbf{r},t)$ at location $\mathbf{r}$ and
time $t$ due to a current distribution $I(\mathbf{r},t)$ is then governed by
the equation $\Delta \phi(\mathbf{r},t) = \frac{1}{\sigma_e} I(\mathbf{r},t)$,
with $\Delta$ denoting the Laplace operator. If the currents $I$ are
constrained to a volume $W$, this equation has the solution: \begin{equation}
\phi(\mathbf{r},t)=\frac{1}{4\pi\sigma_{e}}\int_{W}\frac{I(\mathbf{r}',t)}{|\mathbf{r}-\mathbf{r}'|}\textrm{d}\mathbf{r}'
\label{eqn:basic} \end{equation} Since the majority of the current flows
through the small nondes of Ranvier, we used the point source approximation; we
did not use the line source approximation [@Holt1999Electrical].

Simplified axon bundle model
----------------------------

\label{sec:efpresp}

To better understand the processes leading to the dipolar EFP responses, we
devised an analytically tractable model of the responses. We define the spatial
dimension in cylindrical coordinates $\mathbf{r}=(\rho,\varphi,z)$, and we
consider a simple model axon bundle that extends infinitely in $z$ direction
and lays at $\rho=0$. The bundle has a variable number of fibers along the $z$
axis, denoted by $n(z)$. We assume the axons to be perfect transmission lines,
meaning that the action potential acts like a travelling wave with velocity $v$
along the axon.
<!--This means that the
membrane potential $V$ obeys the following identity at any point:

\begin{align}\frac{\partial V}{\partial z} = \frac{1}{v}\frac{\partial V}{\partial t}\end{align}-->
In particular, we neglect any delays and distortions that can be induced when
an axon branches or terminates. 

In this case, the membrane voltage is the same in each fiber for a given $z$
coordinate. From linear cable theory [e.g. @Jack75Electric], we can then obtain
the following expression for the total transmembrane current $I(z,t)$ from a
given membrane potential $V(z,t)$:
\begin{align}
I(z,t)& = \frac{\partial }{\partial z}\left(n(z)\frac{\partial }{\partial z}V(z,t)\right)\\
&= \frac{\partial n}{\partial z}(z)\cdot\frac{\partial V}{\partial z}(z,t)+n(z)\cdot\frac{\partial ^2V}{\partial z^2}(z,t) 
\end{align}
<!--
\\
&= \frac{\partial n}{\partial z}(z)\cdot\frac{1}{v}\frac{\partial V}{\partial t}(z,t)+n(z)\cdot\frac{1}{v^2}\frac{\partial ^2V}{\partial t^2}(z,t)

from which, together with the fact that the axial conductivity is proportional
to the number of fibers $g_{tot}=ng$ we can then derive the membrane currents
flowing at a given location:

\begin{align}
I(z,t)& = \frac{d}{dz}\left(n(z)\frac{d}{dz}V(z,t)\right)\\
&= \frac{dn}{dz}(z)\cdot\frac{1}{v}\frac{dV}{dt}(z,t)-n(z)\cdot\frac{1}{v^2}\frac{d^2V}{dt^2}(z,t)
\end{align}
-->
Applying this membrane current to equation (\ref{eqn:basic}) we can then
calculate the corresponding extracellular field potential $\phi(\mathbf{r},t)$
of a given $V$ propagating through such an axon bundle. Due to the rotational
symmetry of the system, and the fact that the only current flows at $\rho = 0$,
we get 

\begin{align}\phi(\mathbf{r},t) =\frac{1}{4\pi\sigma_{e}}\int_{-\infty}^{\infty}\frac{I(z',t)}{\sqrt{(z-z')^2 + \rho^2}}\textrm{d}z'
\end{align}
<!--
&=\frac{1}{4\pi\sigma_{e}}\int_{-\infty}^{\infty}\frac{\frac{dn}{dz}(z)\cdot\frac{1}{v}\frac{dV}{dt}(z,t)-n(z)\cdot\frac{1}{v^2}\frac{d^2V}{dt^2}(z,t)}{\sqrt{(z-z')^2 + \rho^2}}\textrm{d}z'

Equation \ref{eqn:infkern} has the form of a convolution with a weighting
function $w$: \begin{equation} w(\rho,z) =
\frac{1}{4\pi\sigma_e}\frac{1}{\sqrt{z^2+\rho^2}} \label{eqn:weighting}
\end{equation}

The convolution can then be written as:

\begin{equation} \Phi(\mathbf{r},t) =
\left[I(z,t)\ast w(\rho,z)\right]_z \end{equation}

with the operator $\left[\cdot\ast\cdot\right]_z$ denoting the convolution with
respect to the variable $z$.
-->

Model fitting to experimental data
----------------------------

In order to relate the model to experimentally obtained data, we performed a
nonlinear least squares fit, minimizing the mean squared error $\epsilon$
between the measured potential $\phi_\text{measured}$ and the model prediction
$\phi_\text{model}$ for all $N = 32$ measurement locations $z_n$ and $M = 600$ timepoints
$t_m$: $\epsilon =
\frac{1}{NM}\sum_{n=0}^{N-1}\sum_{m=0}^{M-1}\left[\phi_\text{measured}(z_n,t_m)-\phi_\text{model}(z_n,t_m)\right]^2$.
We achieved this using the "optimize.minimize" routine provided by the
\textsc{SciPy} package [@scipy]. The free parameters to be determined by the
optimization routine were the distance $\rho$, the conduction velocity $v$, the
fiber density $n(z_n)$ for each measurement location, and the membrane voltage
next to the first electrode $V(z_0,t_m)$ for each timepoint. The membrane
voltage at the other locations was then determined by the traveling wave
assumption: $V(z_n,t_m) = V(z_0,t_m-\frac{z_n-z_0}{v})$, using linear
interpolation between timepoints. The model assumption of a single line of
axons at a fixed distance is a strong simplification, since the fibers are most
likely distributed all around the electrode. The distance parameter $\rho$ can
be thought of as an average distance in this simplification.

To aid the convergence of the algorithm, an
initial guess for the density of the fibers was set by hand. Initializing the
guess to constant or fully random density caused a failure to converge, but we
found that several gaussian-like initial guesses converged to an almost
identical solution, meaning that the specific initial guess did not
significantly alter the fit result. The results shown here were obtained with
an initial guess of a gaussian with amplitude 12, mean at penetration depth
725 $\mu$m, and standard deviation 400 $\mu$m.

<!--
* Show how a dipole emerges in simple case
* Flesh out frequency response
* Can the inverse problem be solved ($v$,$n$,$V$)?

$$\tilde{I}(z,\omega) = i\frac{dn}{dz}(z)\cdot\frac{\omega}{v}\tilde{V}(z,\omega)-n(z)\cdot\frac{\omega^2}{v^2}\tilde{V}(z,\omega)$$
$$\left|\tilde{I}(z,\omega)\right| = \sqrt{\left(\frac{dn}{dz}(z)\right)^2+\left(n(z)\cdot\frac{\omega}{v}\right)^2}\cdot\frac{\omega}{v}\left|\tilde{V}(z,\omega)\right|$$

Todos
=====
- Code
    - adapt generic bundle params to be more typical
    - make click psth more generic
    - check units
- Introduction
    - find more examples in literature
- Results
    - move forward effect explanation and describe [@fig:simpletree]
    - Page 4 changes
    - much more substantial explanation of [@fig:distscaling]
    - describe differences between barn owl and generic model
    - Add more biological motivation for [@fig:distscaling] normalization
- Figures
    - [@fig:simpletree]
        - add input intensity gaussian
        - use labels E1, E2, E3, F1, F2
        - switch E2 and E3
        - more space between panels
        - add scalebars to each panel
        - superimpose CSD and EFP?
    - [@fig:bigtree]
        - lower density of axons
        - Add scalebar for time
        - change color of axis label
        - change color of box
        - add PSTH
        - align zeros in C
        - add contour labels?
    - [@fig:barnowl]
        - redo with new data
    - [@fig:distscaling]
        - add diagrams
        - space between B and C
        - better location for axial scaling
    - [@fig:anamodel]Bb log scale
- Methods
    - Adapt analytical model to new method
    - Add simplified explanations of:
        - spatial filtering
        - dipole/stationary potentials
    - relationship to CSD
- Discussion
- Abstract

Done
* Code
    - pandoc figure refs
    - implement new simplification
- Figures
    - [@fig:simpletree]
        - caption
        - single axons
            - straight
            - branching
            - terminating
        - compound
        - single axons
            - multibranch
            - endings and snips
        - Figures E and F
          - PSTH
          - CSD
        - better alignment in D
    - [@fig:bigtree]
        - version with MUA
-->

Bibliophraphy
===

